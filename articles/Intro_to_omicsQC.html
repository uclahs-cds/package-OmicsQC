<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="OmicsQC">
<title>Introduction to omicsQC • OmicsQC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to omicsQC">
<meta property="og:description" content="OmicsQC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">OmicsQC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Intro_to_omicsQC.html">Introduction to omicsQC</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Intro_to_omicsQC_files/kePrint-0.0.1/kePrint.js"></script><link href="Intro_to_omicsQC_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to omicsQC</h1>
            
      
      
      <div class="d-none name"><code>Intro_to_omicsQC.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>OmicsQC is a package designed to analyze quality control metrics for
multi-sample studies and nominate putative outlier samples for exclusion
using unbiased statistical approaches. The package can be subdivided
into three parts: quality score calculation, outlier detection, and data
visualization. The flowchart below illustrates how these parts interact
and the flow of data throughout the package. The package comes with
example data, consisting of 100 samples from a recent profiling study
that all have been scored according to 26 quality control metrics.</p>
<p><img src="omicsQCFlowchart.png" width="80%"></p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Loading package and importing example data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">OmicsQC</span><span class="op">)</span>;</span>
<span></span>
<span><span class="co"># Loading Data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'example.qc.dataframe'</span><span class="op">)</span>; <span class="co"># Metric scores across samples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'sign.correction'</span><span class="op">)</span>; <span class="co"># The directionality of metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'ylabels'</span><span class="op">)</span>; <span class="co"># Formatted metric labels for heatmap</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generation-and-aggregation-of-z-scores">Generation and aggregation of z-scores<a class="anchor" aria-label="anchor" href="#generation-and-aggregation-of-z-scores"></a>
</h2>
<p>To get a total score for the quality of a sample, this package will
calculate the z-score of each test metric for each sample, correct for
the directionality of each metric, and aggregate the z-scores by the sum
across metrics. This package can be used independent of test metrics
used.</p>
<div class="section level4">
<h4 id="calculation-of-z-scores">Calculation of z-scores<a class="anchor" aria-label="anchor" href="#calculation-of-z-scores"></a>
</h4>
<p><code>zscores.from.metrics</code> takes quality control data for each
sample and calculates the z-score across each metric. Each row of
<code>qc.data</code> should correspond to a sample, and each column to a
test metric. An example input dataframe can be seen below.</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
UniquelyMapped.Percent.Input
</th>
<th style="text-align:right;">
Unmapped.Percent.Input
</th>
<th style="text-align:right;">
MultiMapped.Percent.Input
</th>
<th style="text-align:right;">
UniquelyMapped.Percent.IP
</th>
<th style="text-align:right;">
Unmapped.Percent.IP
</th>
<th style="text-align:right;">
MultiMapped.Percent.IP
</th>
<th style="text-align:right;">
UniquelyMapped.Count.Input
</th>
<th style="text-align:right;">
Unmapped.Count.Input
</th>
<th style="text-align:right;">
MultiMapped.Count.Input
</th>
<th style="text-align:right;">
UniquelyMapped.Count.IP
</th>
<th style="text-align:right;">
Unmapped.Count.IP
</th>
<th style="text-align:right;">
MultiMapped.Count.IP
</th>
<th style="text-align:right;">
FailedToDetermine.Input
</th>
<th style="text-align:right;">
1++,1–,2+-,2-+.Input
</th>
<th style="text-align:right;">
1+-,1-+,2++,2–.Input
</th>
<th style="text-align:right;">
FailedToDetermine.IP
</th>
<th style="text-align:right;">
1++,1–,2+-,2-+.IP
</th>
<th style="text-align:right;">
1+-,1-+,2++,2–.IP
</th>
<th style="text-align:right;">
Adapter1.percent.Input
</th>
<th style="text-align:right;">
Adapter2.percent.Input
</th>
<th style="text-align:right;">
Adapter1.percent.IP
</th>
<th style="text-align:right;">
Adapter2.percent.IP
</th>
<th style="text-align:right;">
PercentEK12.Input
</th>
<th style="text-align:right;">
PercentEK12.IP
</th>
<th style="text-align:right;">
Bulk.Rho
</th>
<th style="text-align:right;">
Array.Rho
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
CPCG0100
</td>
<td style="text-align:right;">
70.25
</td>
<td style="text-align:right;">
10.97
</td>
<td style="text-align:right;">
18.79
</td>
<td style="text-align:right;">
71.43
</td>
<td style="text-align:right;">
18.94
</td>
<td style="text-align:right;">
9.63
</td>
<td style="text-align:right;">
19390677
</td>
<td style="text-align:right;">
3026043
</td>
<td style="text-align:right;">
5184967
</td>
<td style="text-align:right;">
35552770
</td>
<td style="text-align:right;">
9427024
</td>
<td style="text-align:right;">
4795939
</td>
<td style="text-align:right;">
0.1052
</td>
<td style="text-align:right;">
0.0561
</td>
<td style="text-align:right;">
0.8387
</td>
<td style="text-align:right;">
0.0859
</td>
<td style="text-align:right;">
0.0876
</td>
<td style="text-align:right;">
0.8264
</td>
<td style="text-align:right;">
37.29189
</td>
<td style="text-align:right;">
37.13687
</td>
<td style="text-align:right;">
11.174902
</td>
<td style="text-align:right;">
12.12284
</td>
<td style="text-align:right;">
10.088863
</td>
<td style="text-align:right;">
17.83939
</td>
<td style="text-align:right;">
0.6871488
</td>
<td style="text-align:right;">
0.5134328
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0183
</td>
<td style="text-align:right;">
69.29
</td>
<td style="text-align:right;">
8.75
</td>
<td style="text-align:right;">
21.95
</td>
<td style="text-align:right;">
76.34
</td>
<td style="text-align:right;">
12.32
</td>
<td style="text-align:right;">
11.34
</td>
<td style="text-align:right;">
21602350
</td>
<td style="text-align:right;">
2729165
</td>
<td style="text-align:right;">
6845636
</td>
<td style="text-align:right;">
30383237
</td>
<td style="text-align:right;">
4902919
</td>
<td style="text-align:right;">
4514371
</td>
<td style="text-align:right;">
0.1128
</td>
<td style="text-align:right;">
0.0418
</td>
<td style="text-align:right;">
0.8453
</td>
<td style="text-align:right;">
0.1000
</td>
<td style="text-align:right;">
0.0943
</td>
<td style="text-align:right;">
0.8057
</td>
<td style="text-align:right;">
22.18476
</td>
<td style="text-align:right;">
22.30754
</td>
<td style="text-align:right;">
9.909489
</td>
<td style="text-align:right;">
11.40783
</td>
<td style="text-align:right;">
6.695480
</td>
<td style="text-align:right;">
11.11634
</td>
<td style="text-align:right;">
0.6792404
</td>
<td style="text-align:right;">
0.5317954
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0184
</td>
<td style="text-align:right;">
64.60
</td>
<td style="text-align:right;">
11.24
</td>
<td style="text-align:right;">
24.15
</td>
<td style="text-align:right;">
62.30
</td>
<td style="text-align:right;">
15.82
</td>
<td style="text-align:right;">
21.88
</td>
<td style="text-align:right;">
29991436
</td>
<td style="text-align:right;">
5220018
</td>
<td style="text-align:right;">
11212198
</td>
<td style="text-align:right;">
34749241
</td>
<td style="text-align:right;">
8820783
</td>
<td style="text-align:right;">
12206427
</td>
<td style="text-align:right;">
0.1851
</td>
<td style="text-align:right;">
0.0379
</td>
<td style="text-align:right;">
0.7769
</td>
<td style="text-align:right;">
0.1049
</td>
<td style="text-align:right;">
0.0673
</td>
<td style="text-align:right;">
0.8279
</td>
<td style="text-align:right;">
33.41293
</td>
<td style="text-align:right;">
33.27873
</td>
<td style="text-align:right;">
17.675824
</td>
<td style="text-align:right;">
18.62967
</td>
<td style="text-align:right;">
7.911547
</td>
<td style="text-align:right;">
12.86091
</td>
<td style="text-align:right;">
0.7057109
</td>
<td style="text-align:right;">
0.5323726
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0191
</td>
<td style="text-align:right;">
64.12
</td>
<td style="text-align:right;">
13.95
</td>
<td style="text-align:right;">
21.94
</td>
<td style="text-align:right;">
77.26
</td>
<td style="text-align:right;">
10.66
</td>
<td style="text-align:right;">
12.08
</td>
<td style="text-align:right;">
39537338
</td>
<td style="text-align:right;">
8598400
</td>
<td style="text-align:right;">
13522075
</td>
<td style="text-align:right;">
40261018
</td>
<td style="text-align:right;">
5552929
</td>
<td style="text-align:right;">
6295091
</td>
<td style="text-align:right;">
0.1993
</td>
<td style="text-align:right;">
0.0412
</td>
<td style="text-align:right;">
0.7595
</td>
<td style="text-align:right;">
0.1194
</td>
<td style="text-align:right;">
0.0640
</td>
<td style="text-align:right;">
0.8166
</td>
<td style="text-align:right;">
42.73819
</td>
<td style="text-align:right;">
42.77692
</td>
<td style="text-align:right;">
23.696300
</td>
<td style="text-align:right;">
24.86895
</td>
<td style="text-align:right;">
4.845386
</td>
<td style="text-align:right;">
10.48673
</td>
<td style="text-align:right;">
0.6795978
</td>
<td style="text-align:right;">
0.4941515
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0192
</td>
<td style="text-align:right;">
64.38
</td>
<td style="text-align:right;">
13.01
</td>
<td style="text-align:right;">
22.62
</td>
<td style="text-align:right;">
79.51
</td>
<td style="text-align:right;">
7.97
</td>
<td style="text-align:right;">
12.52
</td>
<td style="text-align:right;">
39035170
</td>
<td style="text-align:right;">
7888213
</td>
<td style="text-align:right;">
13713112
</td>
<td style="text-align:right;">
38755562
</td>
<td style="text-align:right;">
3883013
</td>
<td style="text-align:right;">
6102481
</td>
<td style="text-align:right;">
0.3495
</td>
<td style="text-align:right;">
0.0405
</td>
<td style="text-align:right;">
0.6099
</td>
<td style="text-align:right;">
0.1522
</td>
<td style="text-align:right;">
0.0764
</td>
<td style="text-align:right;">
0.7714
</td>
<td style="text-align:right;">
38.90706
</td>
<td style="text-align:right;">
38.96469
</td>
<td style="text-align:right;">
17.103888
</td>
<td style="text-align:right;">
18.34758
</td>
<td style="text-align:right;">
4.815169
</td>
<td style="text-align:right;">
11.28928
</td>
<td style="text-align:right;">
0.6795978
</td>
<td style="text-align:right;">
0.4941515
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0196
</td>
<td style="text-align:right;">
64.85
</td>
<td style="text-align:right;">
13.58
</td>
<td style="text-align:right;">
21.57
</td>
<td style="text-align:right;">
69.92
</td>
<td style="text-align:right;">
20.30
</td>
<td style="text-align:right;">
9.77
</td>
<td style="text-align:right;">
29623574
</td>
<td style="text-align:right;">
6200466
</td>
<td style="text-align:right;">
9853011
</td>
<td style="text-align:right;">
51581803
</td>
<td style="text-align:right;">
14978568
</td>
<td style="text-align:right;">
7209183
</td>
<td style="text-align:right;">
0.1721
</td>
<td style="text-align:right;">
0.0472
</td>
<td style="text-align:right;">
0.7807
</td>
<td style="text-align:right;">
0.0913
</td>
<td style="text-align:right;">
0.0692
</td>
<td style="text-align:right;">
0.8395
</td>
<td style="text-align:right;">
37.05674
</td>
<td style="text-align:right;">
36.74628
</td>
<td style="text-align:right;">
22.523467
</td>
<td style="text-align:right;">
23.25110
</td>
<td style="text-align:right;">
8.992902
</td>
<td style="text-align:right;">
15.51477
</td>
<td style="text-align:right;">
0.7109169
</td>
<td style="text-align:right;">
0.5246630
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zscores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zscores.from.metrics.html">zscores.from.metrics</a></span><span class="op">(</span>qc.data <span class="op">=</span> <span class="va">example.qc.dataframe</span><span class="op">)</span>;</span></code></pre></div>
<p>The function returns a dataframe containing the z-scores for each
sample and test metric. The example data in this package would return
the dataframe below.</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
UniquelyMapped.Percent.Input
</th>
<th style="text-align:right;">
Unmapped.Percent.Input
</th>
<th style="text-align:right;">
MultiMapped.Percent.Input
</th>
<th style="text-align:right;">
UniquelyMapped.Percent.IP
</th>
<th style="text-align:right;">
Unmapped.Percent.IP
</th>
<th style="text-align:right;">
MultiMapped.Percent.IP
</th>
<th style="text-align:right;">
UniquelyMapped.Count.Input
</th>
<th style="text-align:right;">
Unmapped.Count.Input
</th>
<th style="text-align:right;">
MultiMapped.Count.Input
</th>
<th style="text-align:right;">
UniquelyMapped.Count.IP
</th>
<th style="text-align:right;">
Unmapped.Count.IP
</th>
<th style="text-align:right;">
MultiMapped.Count.IP
</th>
<th style="text-align:right;">
FailedToDetermine.Input
</th>
<th style="text-align:right;">
1++,1–,2+-,2-+.Input
</th>
<th style="text-align:right;">
1+-,1-+,2++,2–.Input
</th>
<th style="text-align:right;">
FailedToDetermine.IP
</th>
<th style="text-align:right;">
1++,1–,2+-,2-+.IP
</th>
<th style="text-align:right;">
1+-,1-+,2++,2–.IP
</th>
<th style="text-align:right;">
Adapter1.percent.Input
</th>
<th style="text-align:right;">
Adapter2.percent.Input
</th>
<th style="text-align:right;">
Adapter1.percent.IP
</th>
<th style="text-align:right;">
Adapter2.percent.IP
</th>
<th style="text-align:right;">
PercentEK12.Input
</th>
<th style="text-align:right;">
PercentEK12.IP
</th>
<th style="text-align:right;">
Bulk.Rho
</th>
<th style="text-align:right;">
Array.Rho
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
CPCG0100
</td>
<td style="text-align:right;">
0.5448279
</td>
<td style="text-align:right;">
-0.2092575
</td>
<td style="text-align:right;">
-0.5398954
</td>
<td style="text-align:right;">
0.2808877
</td>
<td style="text-align:right;">
0.0305740
</td>
<td style="text-align:right;">
-0.7730446
</td>
<td style="text-align:right;">
-1.1795856
</td>
<td style="text-align:right;">
-0.9100092
</td>
<td style="text-align:right;">
-1.2412323
</td>
<td style="text-align:right;">
0.0342785
</td>
<td style="text-align:right;">
-0.0537049
</td>
<td style="text-align:right;">
-0.5359233
</td>
<td style="text-align:right;">
-0.7183556
</td>
<td style="text-align:right;">
0.1187405
</td>
<td style="text-align:right;">
0.7065515
</td>
<td style="text-align:right;">
-0.2352108
</td>
<td style="text-align:right;">
-0.0394160
</td>
<td style="text-align:right;">
0.2638734
</td>
<td style="text-align:right;">
0.1661573
</td>
<td style="text-align:right;">
0.1624467
</td>
<td style="text-align:right;">
-0.9010710
</td>
<td style="text-align:right;">
-0.9246914
</td>
<td style="text-align:right;">
0.8904284
</td>
<td style="text-align:right;">
0.7404171
</td>
<td style="text-align:right;">
0.1709534
</td>
<td style="text-align:right;">
0.4181559
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0183
</td>
<td style="text-align:right;">
0.4128684
</td>
<td style="text-align:right;">
-0.7502515
</td>
<td style="text-align:right;">
0.0112496
</td>
<td style="text-align:right;">
0.7458771
</td>
<td style="text-align:right;">
-0.5547355
</td>
<td style="text-align:right;">
-0.3739424
</td>
<td style="text-align:right;">
-1.0165807
</td>
<td style="text-align:right;">
-0.9877796
</td>
<td style="text-align:right;">
-0.9230678
</td>
<td style="text-align:right;">
-0.2689982
</td>
<td style="text-align:right;">
-0.5357854
</td>
<td style="text-align:right;">
-0.6190383
</td>
<td style="text-align:right;">
-0.6594594
</td>
<td style="text-align:right;">
-0.4550984
</td>
<td style="text-align:right;">
0.7585148
</td>
<td style="text-align:right;">
-0.0385626
</td>
<td style="text-align:right;">
0.1614107
</td>
<td style="text-align:right;">
-0.0382884
</td>
<td style="text-align:right;">
-0.7802375
</td>
<td style="text-align:right;">
-0.7814451
</td>
<td style="text-align:right;">
-1.0311481
</td>
<td style="text-align:right;">
-1.0001724
</td>
<td style="text-align:right;">
-0.0273160
</td>
<td style="text-align:right;">
-0.2719865
</td>
<td style="text-align:right;">
0.0844681
</td>
<td style="text-align:right;">
0.7407992
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0184
</td>
<td style="text-align:right;">
-0.2318089
</td>
<td style="text-align:right;">
-0.1434609
</td>
<td style="text-align:right;">
0.3949582
</td>
<td style="text-align:right;">
-0.5837463
</td>
<td style="text-align:right;">
-0.2452818
</td>
<td style="text-align:right;">
2.0860207
</td>
<td style="text-align:right;">
-0.3982875
</td>
<td style="text-align:right;">
-0.3352732
</td>
<td style="text-align:right;">
-0.0864865
</td>
<td style="text-align:right;">
-0.0128615
</td>
<td style="text-align:right;">
-0.1183048
</td>
<td style="text-align:right;">
1.6515511
</td>
<td style="text-align:right;">
-0.0991704
</td>
<td style="text-align:right;">
-0.6115999
</td>
<td style="text-align:right;">
0.2199859
</td>
<td style="text-align:right;">
0.0297762
</td>
<td style="text-align:right;">
-0.6478908
</td>
<td style="text-align:right;">
0.2857692
</td>
<td style="text-align:right;">
-0.0768423
</td>
<td style="text-align:right;">
-0.0831253
</td>
<td style="text-align:right;">
-0.2328137
</td>
<td style="text-align:right;">
-0.2377904
</td>
<td style="text-align:right;">
0.3015706
</td>
<td style="text-align:right;">
-0.0092771
</td>
<td style="text-align:right;">
0.3739437
</td>
<td style="text-align:right;">
0.7509409
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0191
</td>
<td style="text-align:right;">
-0.2977887
</td>
<td style="text-align:right;">
0.5169417
</td>
<td style="text-align:right;">
0.0095055
</td>
<td style="text-align:right;">
0.8330034
</td>
<td style="text-align:right;">
-0.7015049
</td>
<td style="text-align:right;">
-0.2012315
</td>
<td style="text-align:right;">
0.3052655
</td>
<td style="text-align:right;">
0.5497312
</td>
<td style="text-align:right;">
0.3560584
</td>
<td style="text-align:right;">
0.3104933
</td>
<td style="text-align:right;">
-0.4665215
</td>
<td style="text-align:right;">
-0.0933942
</td>
<td style="text-align:right;">
0.0108726
</td>
<td style="text-align:right;">
-0.4791755
</td>
<td style="text-align:right;">
0.0829917
</td>
<td style="text-align:right;">
0.2320031
</td>
<td style="text-align:right;">
-0.7468054
</td>
<td style="text-align:right;">
0.1208209
</td>
<td style="text-align:right;">
0.5073442
</td>
<td style="text-align:right;">
0.5214372
</td>
<td style="text-align:right;">
0.3860564
</td>
<td style="text-align:right;">
0.4208663
</td>
<td style="text-align:right;">
-0.5276761
</td>
<td style="text-align:right;">
-0.3667977
</td>
<td style="text-align:right;">
0.0883766
</td>
<td style="text-align:right;">
0.0793716
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0192
</td>
<td style="text-align:right;">
-0.2620496
</td>
<td style="text-align:right;">
0.2878722
</td>
<td style="text-align:right;">
0.1281063
</td>
<td style="text-align:right;">
1.0460840
</td>
<td style="text-align:right;">
-0.9393421
</td>
<td style="text-align:right;">
-0.0985386
</td>
<td style="text-align:right;">
0.2682546
</td>
<td style="text-align:right;">
0.3636899
</td>
<td style="text-align:right;">
0.3926589
</td>
<td style="text-align:right;">
0.2221740
</td>
<td style="text-align:right;">
-0.6444647
</td>
<td style="text-align:right;">
-0.1502500
</td>
<td style="text-align:right;">
1.1748478
</td>
<td style="text-align:right;">
-0.5072655
</td>
<td style="text-align:right;">
-1.0948434
</td>
<td style="text-align:right;">
0.6894543
</td>
<td style="text-align:right;">
-0.3751262
</td>
<td style="text-align:right;">
-0.5389720
</td>
<td style="text-align:right;">
0.2673407
</td>
<td style="text-align:right;">
0.2787879
</td>
<td style="text-align:right;">
-0.2916055
</td>
<td style="text-align:right;">
-0.2675694
</td>
<td style="text-align:right;">
-0.5358483
</td>
<td style="text-align:right;">
-0.2459436
</td>
<td style="text-align:right;">
0.0883766
</td>
<td style="text-align:right;">
0.0793716
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0196
</td>
<td style="text-align:right;">
-0.1974444
</td>
<td style="text-align:right;">
0.4267760
</td>
<td style="text-align:right;">
-0.0550273
</td>
<td style="text-align:right;">
0.1378869
</td>
<td style="text-align:right;">
0.1508189
</td>
<td style="text-align:right;">
-0.7403695
</td>
<td style="text-align:right;">
-0.4253997
</td>
<td style="text-align:right;">
-0.0784340
</td>
<td style="text-align:right;">
-0.3468906
</td>
<td style="text-align:right;">
0.9746403
</td>
<td style="text-align:right;">
0.5378577
</td>
<td style="text-align:right;">
0.1764332
</td>
<td style="text-align:right;">
-0.1999139
</td>
<td style="text-align:right;">
-0.2384040
</td>
<td style="text-align:right;">
0.2499042
</td>
<td style="text-align:right;">
-0.1598987
</td>
<td style="text-align:right;">
-0.5909400
</td>
<td style="text-align:right;">
0.4550966
</td>
<td style="text-align:right;">
0.1514266
</td>
<td style="text-align:right;">
0.1375855
</td>
<td style="text-align:right;">
0.2654958
</td>
<td style="text-align:right;">
0.2500770
</td>
<td style="text-align:right;">
0.5940246
</td>
<td style="text-align:right;">
0.3903588
</td>
<td style="text-align:right;">
0.4308755
</td>
<td style="text-align:right;">
0.6154787
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="adjusting-metric-directionality">Adjusting metric directionality<a class="anchor" aria-label="anchor" href="#adjusting-metric-directionality"></a>
</h4>
<p>This package is designed to be independent of test metrics used, but
since some test metrics are better if they are larger and some are
better if they are smaller, the sign of a poor z-score will differ
between the metrics. We must therefore adjust the metrics such that
negative z-scores is considered a bad measurement across all tests. The
function <code>correct.zscore.signs</code> requires input that states if
a positive or a negative z-score is good for each metric. This input
takes the form of a dataframe with a column for metric and a column for
sign which have the potential values ‘pos’ or ‘neg’ for each metric
used.</p>
<p>The function <code>correct.zscore.signs</code> also sets all
non-negative z-scores to zero to make sure positive and negative values
do not cancel each other out when we calculate an accumulated score.</p>
<p>Apart from the <code>zscores</code>, and <code>signs.data</code>, the
function also takes the names of the columns containing the metric name
and the sign instructions in <code>sign.data</code>.</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Sign
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
UniquelyMapped.Percent.Input
</td>
<td style="text-align:left;">
pos
</td>
</tr>
<tr>
<td style="text-align:left;">
Unmapped.Percent.Input
</td>
<td style="text-align:left;">
neg
</td>
</tr>
<tr>
<td style="text-align:left;">
MultiMapped.Percent.Input
</td>
<td style="text-align:left;">
pos
</td>
</tr>
<tr>
<td style="text-align:left;">
UniquelyMapped.Percent.IP
</td>
<td style="text-align:left;">
pos
</td>
</tr>
<tr>
<td style="text-align:left;">
Unmapped.Percent.IP
</td>
<td style="text-align:left;">
neg
</td>
</tr>
<tr>
<td style="text-align:left;">
MultiMapped.Percent.IP
</td>
<td style="text-align:left;">
pos
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zscores.corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correct.zscore.signs.html">correct.zscore.signs</a></span><span class="op">(</span></span>
<span>  zscores <span class="op">=</span> <span class="va">zscores</span>,</span>
<span>  signs.data <span class="op">=</span> <span class="va">sign.correction</span>,</span>
<span>  metric.col.name <span class="op">=</span> <span class="st">'Metric'</span>,</span>
<span>  signs.col.name <span class="op">=</span> <span class="st">'Sign'</span></span>
<span>  <span class="op">)</span>;</span></code></pre></div>
<p>The output of the function, <code>zscores.corrected</code>, can now
be used to calculate accumulated scores for each sample.</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
UniquelyMapped.Percent.Input
</th>
<th style="text-align:right;">
Unmapped.Percent.Input
</th>
<th style="text-align:right;">
MultiMapped.Percent.Input
</th>
<th style="text-align:right;">
UniquelyMapped.Percent.IP
</th>
<th style="text-align:right;">
Unmapped.Percent.IP
</th>
<th style="text-align:right;">
MultiMapped.Percent.IP
</th>
<th style="text-align:right;">
UniquelyMapped.Count.Input
</th>
<th style="text-align:right;">
Unmapped.Count.Input
</th>
<th style="text-align:right;">
MultiMapped.Count.Input
</th>
<th style="text-align:right;">
UniquelyMapped.Count.IP
</th>
<th style="text-align:right;">
Unmapped.Count.IP
</th>
<th style="text-align:right;">
MultiMapped.Count.IP
</th>
<th style="text-align:right;">
FailedToDetermine.Input
</th>
<th style="text-align:right;">
1++,1–,2+-,2-+.Input
</th>
<th style="text-align:right;">
1+-,1-+,2++,2–.Input
</th>
<th style="text-align:right;">
FailedToDetermine.IP
</th>
<th style="text-align:right;">
1++,1–,2+-,2-+.IP
</th>
<th style="text-align:right;">
1+-,1-+,2++,2–.IP
</th>
<th style="text-align:right;">
Adapter1.percent.Input
</th>
<th style="text-align:right;">
Adapter2.percent.Input
</th>
<th style="text-align:right;">
Adapter1.percent.IP
</th>
<th style="text-align:right;">
Adapter2.percent.IP
</th>
<th style="text-align:right;">
PercentEK12.Input
</th>
<th style="text-align:right;">
PercentEK12.IP
</th>
<th style="text-align:right;">
Bulk.Rho
</th>
<th style="text-align:right;">
Array.Rho
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
CPCG0100
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.5398954
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.0305740
</td>
<td style="text-align:right;">
-0.7730446
</td>
<td style="text-align:right;">
-1.1795856
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-1.2412323
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.5359233
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.1187405
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.1661573
</td>
<td style="text-align:right;">
-0.1624467
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.8904284
</td>
<td style="text-align:right;">
-0.7404171
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0183
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.3739424
</td>
<td style="text-align:right;">
-1.0165807
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.9230678
</td>
<td style="text-align:right;">
-0.2689982
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.6190383
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.1614107
</td>
<td style="text-align:right;">
-0.0382884
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0184
</td>
<td style="text-align:right;">
-0.2318089
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.5837463
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.3982875
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.0864865
</td>
<td style="text-align:right;">
-0.0128615
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
-0.0297762
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.3015706
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0191
</td>
<td style="text-align:right;">
-0.2977887
</td>
<td style="text-align:right;">
-0.5169417
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.2012315
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.5497312
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.0933942
</td>
<td style="text-align:right;">
-0.0108726
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
-0.2320031
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.5073442
</td>
<td style="text-align:right;">
-0.5214372
</td>
<td style="text-align:right;">
-0.3860564
</td>
<td style="text-align:right;">
-0.4208663
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0192
</td>
<td style="text-align:right;">
-0.2620496
</td>
<td style="text-align:right;">
-0.2878722
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.0985386
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.3636899
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.1502500
</td>
<td style="text-align:right;">
-1.1748478
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-1.094843
</td>
<td style="text-align:right;">
-0.6894543
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.5389720
</td>
<td style="text-align:right;">
-0.2673407
</td>
<td style="text-align:right;">
-0.2787879
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0196
</td>
<td style="text-align:right;">
-0.1974444
</td>
<td style="text-align:right;">
-0.4267760
</td>
<td style="text-align:right;">
-0.0550273
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.1508189
</td>
<td style="text-align:right;">
-0.7403695
</td>
<td style="text-align:right;">
-0.4253997
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.3468906
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.5378577
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.1514266
</td>
<td style="text-align:right;">
-0.1375855
</td>
<td style="text-align:right;">
-0.2654958
</td>
<td style="text-align:right;">
-0.2500770
</td>
<td style="text-align:right;">
-0.5940246
</td>
<td style="text-align:right;">
-0.3903588
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="calculating-total-quality-score">Calculating total quality score<a class="anchor" aria-label="anchor" href="#calculating-total-quality-score"></a>
</h4>
<p><code>accumulate.zscores</code> takes the
<code>zscores.corrected</code> dataframe and calculates a total quality
score for each sample. It does this by summing over all negative
z-scores. It then orders the data by the magnitude of the quality score
and returns the result in a dataframe.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quality.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/accumulate.zscores.html">accumulate.zscores</a></span><span class="op">(</span>zscores.corrected <span class="op">=</span> <span class="va">zscores.corrected</span><span class="op">)</span>;</span></code></pre></div>
<p>The resulting <code>quality.scores</code> is shown below:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Sample
</th>
<th style="text-align:right;">
Sum
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
CPCG0184
</td>
<td style="text-align:left;">
CPCG0184
</td>
<td style="text-align:right;">
-1.644537
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0250
</td>
<td style="text-align:left;">
CPCG0250
</td>
<td style="text-align:right;">
-1.648902
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0457
</td>
<td style="text-align:left;">
CPCG0457
</td>
<td style="text-align:right;">
-1.879131
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0236
</td>
<td style="text-align:left;">
CPCG0236
</td>
<td style="text-align:right;">
-1.923124
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0333
</td>
<td style="text-align:left;">
CPCG0333
</td>
<td style="text-align:right;">
-2.009918
</td>
</tr>
<tr>
<td style="text-align:left;">
CPCG0346
</td>
<td style="text-align:left;">
CPCG0346
</td>
<td style="text-align:right;">
-2.057996
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="outlier-detection-using-cosine-similarity">Outlier detection using cosine similarity<a class="anchor" aria-label="anchor" href="#outlier-detection-using-cosine-similarity"></a>
</h2>
<p>The second part of the package offers distribution fitting and
outlier detection using two implementations of the cosine outlier
detection method. They are both based on cosine similarity, but the two
implementations offer pros and cons. Generally speaking, the cutoff
method has a low sensitivity but a high precision, while the iterative
method has a high sensitivity but low precision.</p>
<div class="section level4">
<h4 id="finding-the-best-fitting-distribution">Finding the best fitting distribution<a class="anchor" aria-label="anchor" href="#finding-the-best-fitting-distribution"></a>
</h4>
<p>The function <code>fit.and.evaluate</code> takes the quality.scores
and evaluates how well they fit to some common distributions. It returns
a <a href="https://www.sciencedirect.com/topics/social-sciences/bayesian-information-criterion" class="external-link">Bayesian
Information Criterion</a> score as well as a <a href="https://www.sciencedirect.com/topics/medicine-and-dentistry/kolmogorov-smirnov-test" class="external-link">Kolmogorov–Smirnov</a>
test result for each distribution.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.and.evaluate.html">fit.and.evaluate</a></span><span class="op">(</span></span>
<span>    quality.scores <span class="op">=</span> <span class="va">quality.scores</span>,</span>
<span>    trim.factor <span class="op">=</span> <span class="fl">0.15</span></span>
<span>    <span class="op">)</span>;</span></code></pre></div>
<p><code>fit.and.evaluate</code> returns the dataframe printed
below:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
distribution
</th>
<th style="text-align:left;">
KS.rejected
</th>
<th style="text-align:right;">
BIC.value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
lnorm
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
342.1010
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
gamma
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
346.2334
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
weibull
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
355.5584
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
norm
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
361.3964
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
logis
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
362.2932
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
cauchy
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
375.5290
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
exp
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
423.9251
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="the-iterative-method-for-outlier-nomination-using-cosine-similarity">The iterative method for outlier nomination using cosine
similarity<a class="anchor" aria-label="anchor" href="#the-iterative-method-for-outlier-nomination-using-cosine-similarity"></a>
</h4>
<p>The function <code>cosine.similarity.iterative</code> takes
<code>quality.scores</code>, trims the proportion of data indicated by
<code>trim.factor</code> from each extreme, and fits it to the
distribution given. It then tests the largest datapoint compared a null
distribution of size <code>no.simulations</code>. If the largest
datapoint has a significant p-value, it moves onto the 2nd largest
datapoint and so on, until it reaches a datapoint whose p-value is
insignificant.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outlier.detect.iterative.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosine.similarity.iterative.html">cosine.similarity.iterative</a></span><span class="op">(</span></span>
<span>    quality.scores <span class="op">=</span> <span class="va">quality.scores</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">'lnorm'</span>,</span>
<span>    no.simulations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    trim.factor <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>    alpha.significant <span class="op">=</span> <span class="fl">0.05</span></span>
<span>    <span class="op">)</span>;</span></code></pre></div>
<p>Number of outliers found:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">outlier.detect.iterative.res</span><span class="op">$</span><span class="va">no.outliers</span><span class="op">)</span>;</span>
<span><span class="co">#&gt; [1] 11</span></span></code></pre></div>
<p>The sample labels of the outliers:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">outlier.detect.iterative.res</span><span class="op">$</span><span class="va">outlier.labels</span><span class="op">)</span>;</span>
<span><span class="co">#&gt;  [1] "CPCG0375" "CPCG0382" "CPCG0498" "CPCG0464" "CPCG0437" "CPCG0235"</span></span>
<span><span class="co">#&gt;  [7] "CPCG0486" "CPCG0263" "CPCG0266" "CPCG0256" "CPCG0502"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-cutoff-method-for-outlier-nomination-using-cosine-similarity">The cutoff method for outlier nomination using cosine
similarity<a class="anchor" aria-label="anchor" href="#the-cutoff-method-for-outlier-nomination-using-cosine-similarity"></a>
</h4>
<p>The function <code>cosine.similarity.cutoff</code> takes
<code>quality.scores</code>, trims the proportion of data indicated by
<code>trim.factor</code> from each extreme, and fits it to the
distribution given. It then simulates as many datasets as stated by
<code>no.simulations</code>, and computes the cosine similarity of each
dataset against theoretical distribution. Using this simulatd dataset,
it estimates the cutoff threshold for cosine similarity which would
correspond to a statistically significant p-value (determined by
<code>alpha.significant</code>) and nominates outliers that surpass this
threshold.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outlier.detect.cutoff.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosine.similarity.cutoff.html">cosine.similarity.cutoff</a></span><span class="op">(</span></span>
<span>    quality.scores <span class="op">=</span> <span class="va">quality.scores</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">'lnorm'</span>,</span>
<span>    no.simulations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    trim.factor <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>    alpha.significant <span class="op">=</span> <span class="fl">0.05</span></span>
<span>    <span class="op">)</span>;</span></code></pre></div>
<p>Quality score cutoff:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">outlier.detect.cutoff.res</span><span class="op">$</span><span class="va">cutoff</span><span class="op">)</span>;</span>
<span><span class="co">#&gt;       5% </span></span>
<span><span class="co">#&gt; 24.77938</span></span></code></pre></div>
<p>Number of outliers found:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">outlier.detect.cutoff.res</span><span class="op">$</span><span class="va">no.outliers</span><span class="op">)</span>;</span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>The sample labels of the outliers:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">outlier.detect.cutoff.res</span><span class="op">$</span><span class="va">outlier.labels</span><span class="op">)</span>;</span>
<span><span class="co">#&gt; [1] "CPCG0235" "CPCG0437" "CPCG0464" "CPCG0498" "CPCG0382" "CPCG0375"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="data-visualisation">Data visualisation<a class="anchor" aria-label="anchor" href="#data-visualisation"></a>
</h2>
<p>The third aspect of the package is the visualization of the quality
control data. Several functions have been adapted from the package <a href="https://cran.r-project.org/web/packages/BoutrosLab.plotting.general/BoutrosLab.plotting.general.pdf" class="external-link">BoutrosLab.plotting.general</a>
and customized for the purposes of this package. These functions offer
standardized plots with flexibility for customization to aid in data
visualization.</p>
<div class="section level4">
<h4 id="quality-score-barplot">Quality score barplot<a class="anchor" aria-label="anchor" href="#quality-score-barplot"></a>
</h4>
<p>The function <code>get.qc.barplot</code> takes the accumulated
quality scores (<code>quality.scores</code>) and returns a barplot
displaying the scores from lowest to highest. It can also optionally
depict a cut-off for outlier nomination. If filename is not NULL, it is
saved to file. Otherwise, the trellis object is returned.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc.barplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.qc.barplot.html">get.qc.barplot</a></span><span class="op">(</span></span>
<span>    quality.scores <span class="op">=</span> <span class="va">quality.scores</span>,</span>
<span>    abline.h <span class="op">=</span> <span class="op">-</span> <span class="va">outlier.detect.cutoff.res</span><span class="op">$</span><span class="va">cutoff</span></span>
<span>    <span class="op">)</span>;</span></code></pre></div>
<p><img src="barplot.png" width="80%"></p>
</div>
<div class="section level4">
<h4 id="z-score-heatmap">Z-score heatmap<a class="anchor" aria-label="anchor" href="#z-score-heatmap"></a>
</h4>
<p>The function <code>get.qc.heatmap</code> takes the dataframe with the
corrected z-scores for each sample (<code>zscores.corrected</code>) and
metric as well as a vector of labels (<code>ylabels</code>) for the
y-axis. The labels should be the full names of the metrics in the same
order as they are in the dataframe. The function also takes
<code>quality.scores</code> to make sure the samples are in the correct
order on the heatmap. The function returns a standardized heatmap. If
filename is not NULL, it is saved to file. Otherwise, the trellis object
is returned.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc.heatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.qc.heatmap.html">get.qc.heatmap</a></span><span class="op">(</span></span>
<span>  zscores <span class="op">=</span> <span class="va">zscores.corrected</span>,</span>
<span>  quality.scores <span class="op">=</span> <span class="va">quality.scores</span>,</span>
<span>  yaxis.lab <span class="op">=</span> <span class="va">ylabels</span></span>
<span>  <span class="op">)</span>;</span></code></pre></div>
<p><img src="heatmap.png" width="80%"></p>
</div>
<div class="section level4">
<h4 id="aggregating-the-plots">Aggregating the plots<a class="anchor" aria-label="anchor" href="#aggregating-the-plots"></a>
</h4>
<p>Now that both the heat map and barplot has been generated they can be
aggregated to a multipanelplot. <code>get.qc.multipanelplot</code> takes
the barplot, heatmap and a filename and concatenates the plots in a
standardized format and saves the multipanelplot to file.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc.multipanel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.qc.multipanelplot.html">get.qc.multipanelplot</a></span><span class="op">(</span></span>
<span>  barplot <span class="op">=</span> <span class="va">qc.barplot</span>,</span>
<span>  heatmap <span class="op">=</span> <span class="va">qc.heatmap</span></span>
<span>  <span class="op">)</span>;</span></code></pre></div>
<p><img src="multipanelplot.png" width="80%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Anders Hugo Frelin, Helen Zhu, Paul C. Boutros.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
